# 键盘控制使用说明

## 概述

现在 RoboMimic_Deploy 支持键盘控制！当没有检测到手柄时，系统将自动切换到键盘控制模式。

## 键盘映射

### 按键映射 (对应手柄按键)
- **J** → A 按键 (PS: ×, Xbox: A)
- **K** → B 按键 (PS: ○, Xbox: B) 
- **U** → X 按键 (PS: □, Xbox: X)
- **I** → Y 按键 (PS: △, Xbox: Y)
- **Q** → L1 按键 (左肩键)
- **E** → R1 按键 (右肩键)
- **Space** → START 按键
- **Esc** → SELECT 按键 (退出程序)
- **F** → L3 按键 (左摇杆按下)
- **G** → R3 按键 (右摇杆按下)
- **H** → HOME 按键

### 移动控制 (模拟摇杆)
- **WASD** → 左摇杆 (主要移动控制)
  - W/S: 前进/后退
  - A/D: 左右移动
- **Shift + 方向键** → 右摇杆 (旋转控制)
  - Shift + ↑/↓: 前后倾斜
  - Shift + ←/→: 左右转向

### 方向键 (D-pad)
- **方向键** (不按Shift时) → D-pad 控制

## 控制命令映射

### 状态切换
- **F (L3)** → 被动模式 (PASSIVE)
- **Space (START)** → 姿态重置 (POS_RESET)

### 技能切换 (需要配合肩键)
- **J + E (A + R1)** → 移动模式 (LOCO)
- **U + E (X + R1)** → 技能1 (SKILL_1)
- **I + E (Y + R1)** → 技能2 (SKILL_2) 
- **K + E (B + R1)** → 技能3 (SKILL_3)
- **I + Q (Y + L1)** → 技能4 (SKILL_4)

### 速度控制
- **WASD** → 控制机器人的移动速度
  - W/S: 线速度 (前进/后退)
  - A/D: 侧向速度 (左/右)
- **Shift + ←/→** → 角速度 (旋转)

## 使用方法

### ⚠️ 重要：操作界面说明

**键盘输入在独立的控制窗口中进行，不是在MuJoCo窗口！**

MuJoCo窗口有自己的快捷键系统，会与我们的控制冲突。因此系统会创建一个专门的控制窗口。

1. **启动程序**:
   ```bash
   cd deploy_mujoco
   python deploy_mujoco.py
   ```

2. **等待窗口出现**: 程序会显示三个窗口：
   - **终端窗口**：显示程序状态和调试信息
   - **MuJoCo 仿真窗口**：3D机器人仿真界面（只用于观看）
   - **Robot Keyboard Controller 窗口**：专门的键盘控制窗口

3. **激活控制窗口**: 
   - **点击 "Robot Keyboard Controller" 窗口**使其获得焦点
   - 窗口会显示控制说明
   - 现在可以在这个窗口中使用键盘控制

4. **开始控制**: 在控制窗口中按相应的键进行控制

5. **退出程序**: 在控制窗口中按 **Esc** 键退出

## 测试键盘功能

运行测试脚本来验证键盘输入是否正常工作：

```bash
python test_keyboard.py
```

这个测试程序会显示按键状态和轴值，帮助你熟悉控制方式。

## 注意事项

1. **⚠️ 最重要**：键盘输入必须在 **"Robot Keyboard Controller" 窗口** 中进行！
   - 不是在终端窗口
   - 不是在MuJoCo窗口（MuJoCo有自己的快捷键会冲突）

2. **窗口焦点**: 确保控制窗口处于激活状态（点击窗口使其获得焦点）。

3. **按键组合**: 某些功能需要按键组合（如技能切换需要同时按住肩键）。

4. **数字输入**: 键盘输入是数字化的（-1, 0, 1），不像手柄有模拟输入。

5. **依赖项**: 确保安装了pygame：
   ```bash
   pip install pygame
   ```

## 故障排除

- **无响应**: 检查窗口是否有焦点
- **按键不工作**: 确认pygame正确安装
- **退出问题**: 使用Esc键或关闭窗口

现在你可以在没有手柄的情况下也能控制机器人了！
